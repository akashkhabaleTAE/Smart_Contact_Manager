<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{user-views/user-base::layout(~{::section})}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <title>DASHBOARD</title>
</head>
<body>
<section>
    <div class="container mt-2">

        <!--Welcome, Banner -->
        <div class="alert alert-info alert-dismissible fade show" role="alert">
            <h4 class="alert-heading">Welcome, <span th:text="${user.name}">User</span>! ðŸ‘‹</h4>
            <p class="mb-0">Manage your contacts efficiently with Smart Contact Manager.</p>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>

        <div class="row">
            <!-- User Profile Card -->
            <div class="col-md-4 mb-4">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white text-center">
                        <h5 class="mb-0">Profile</h5>
                    </div>
                    <div class="card-body text-center">
                        <!-- User Image -->
                        <img th:src="@{${user.imageUrl != null ? '/images/users/' + user.imageUrl : '/images/default-user.png'}}"
                             alt="Profile Photo"
                             src="#"
                             class="rounded-circle shadow mb-3"
                             style="width: 150px; height: 150px; object-fit: cover;">

                        <h4 th:text="${user.name}">User Name</h4>
                        <p class="text-muted" th:text="${user.email}">user@example.com</p>

                        <span class="badge badge-success" th:if="${user.enabled}">Active</span>
                        <span class="badge badge-danger" th:unless="${user.enabled}">Inactive</span>

                        <hr>

                        <div class="text-left">
                            <p><strong>Role:</strong>
                                <span class="badge badge-primary" th:text="${user.userRole}">USER</span>
                            </p>
                            <p><strong>About:</strong></p>
                            <div th:utext="${user.about}" class="text-muted small">About content</div>
                        </div>

                        <a th:href="@{'/users/editProfile/' + ${user.id}}" class="btn btn-outline-primary btn-sm mt-3">Edit Profile</a>
                    </div>
                </div>
            </div>

            <!-- Statistics & Quick Actions -->
            <div class="col-md-8">

                <!-- Statistics Cards -->
                <div class="row mb-4">
                    <div class="col-md-6 mb-3">
                        <div class="card shadow-sm border-left-primary">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                            Total Contacts
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800"
                                             th:text="${user.contacts.size()}">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-users fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <div class="card shadow-sm border-left-success">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                            Account Status
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold"
                                             th:class="${user.enabled ? 'text-success' : 'text-danger'}"
                                             th:text="${user.enabled ? 'Active' : 'Inactive'}">Active</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-check-circle fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions Card -->
                <div class="card shadow mb-4">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">Quick Actions</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <a th:href="@{/users/addContact}" class="btn btn-primary btn-block">
                                    <i class="fas fa-plus-circle"></i> Add New Contact
                                </a>
                            </div>
                            <div class="col-md-6 mb-3">
                                <a th:href="@{/users/viewContacts/0}" class="btn btn-info btn-block">
                                    <i class="fas fa-list"></i> View All Contacts
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Contacts Card -->
                <div class="card shadow">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0">Recent Contacts</h5>
                    </div>
                    <div class="card-body">

                        <!-- If no contacts -->
                        <div th:if="${user.contacts.isEmpty()}" class="text-center text-muted py-4">
                            <i class="fas fa-address-book fa-3x mb-3"></i>
                            <p>No contacts yet. Start by adding your first contact!</p>
                            <a th:href="@{/users/addContact}" class="btn btn-primary">Add Contact</a>
                        </div>

                        <!-- Recent contacts list -->
                        <div th:unless="${user.contacts.isEmpty()}">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"
                                    th:each="contact, iterStat : ${user.contacts}"
                                    th:if="${iterStat.index < 5}">
                                    <div class="d-flex align-items-center">
                                        <img th:src="@{'/images/' + ${contact.image}}"
                                             alt="Contact"
                                             src="#"
                                             class="rounded-circle mr-3"
                                             style="width: 40px; height: 40px; object-fit: cover;">
                                        <div class="flex-grow-1">
                                            <strong th:text="${contact.firstName + ' ' + contact.lastName}">Name</strong>
                                            <br>
                                            <small class="text-muted" th:text="${contact.email}">email</small>
                                        </div>
                                        <a th:href="@{'/users/viewContactDetails/' + ${contact.id}}"
                                           class="btn btn-sm btn-outline-primary">View</a>
                                    </div>
                                </li>
                            </ul>

                            <div class="text-center mt-3" th:if="${user.contacts.size() > 5}">
                                <a th:href="@{/users/viewContacts/0}" class="btn btn-sm btn-link">
                                    View all <span th:text="${user.contacts.size()}">0</span> contacts â†’
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</section>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>